%  Template der Einverständniserklärungen

\documentclass[oneside,12pt, headinclude=true, footinclude=false]{scrreprt}

% Alle Stildefinitionen, Pakete und Befehle werden in rhp.sty definiert.
\usepackage{rhp}

\begin{document}

%\pagestyle{empty}

\BLOCK{for vl in vorlesungen}
\BLOCK{if vl.antwortboegen.all()|count > 0}
\BLOCK{for dozent in vl.get_personal()}

\setcounter{page}{1}

\Kopfklein{\VAR{vl.name}}{\VAR{ vl.dozenten.all()|concat}}

Liebe(r) \VAR{dozent[1].name},

\BLOCK{if dozent[1].einverst}

die Vorlesungsumfrage ist nun ausgewertet. Sie haben bei der Fachschaft eine
dauerhafte Einverständniserklärung abgegeben. Sie können gegen die
Veröffentlichung der Umfrageergebnisse inkl. Kommentare Einspruch einlegen,
müssen dies aber binnen \textbf{einer Woche} nach Erhalt dieses Dokumentes
tun. Wir bitten Sie, die Sie betreffenden Stellen zu prüfen.

Sollten Sie einzelne Kommentare als unangebracht, beleidigend oder dem Zweck
der Vorlesungsumfrage nicht dienlich erachten, markieren Sie diese bitte. Wir
werden dann prüfen, ob die Kommentare gegebenenfalls gestrichen werden.

Wenn Sie die Dauerhafte Einverständniserklärung widerrufen wollen, können Sie
der Fachschaft den vorgesehenen Abschnitt zukommen lassen.

\textbf{Bitte nehmen Sie sich die Zeit, die Ergebnisse genau durchzulesen und
  mit den Studierenden zu besprechen. Nur so kann die Lehre an unserem
  Fachbereich stetig verbessert werden.}

\vfill

\dingline{34}

Hiermit \textbf{widerspreche} ich dem Druck der mich betreffenden Ergebnisse
der Vorlesungsumfrage {\bf \VAR{vlu.name}} in der Renthofpostille.

\begin{tabular}{p{3cm}p{8cm}}
\vspace{0.5cm}   Datum:        &\\
\vspace{0.1cm} Name:         &\vspace{0.1cm}{\bf \VAR{dozent[1].name}}\\
\vspace{0.1cm} Unterschrift: &\\
\end{tabular}

\vspace{1cm}

\dingline{34}

Hiermit \textbf{widerrufe} ich die dauerhafte Einverständniserklärung zur
Veröffentlichung der Umfrageergebnisse.

\begin{tabular}{p{3cm}p{8cm}}
\vspace{0.5cm}   Datum:        &\\
\vspace{0.1cm} Name:         &\vspace{0.1cm}{\bf \VAR{dozent[1].name}}\\
\vspace{0.1cm} Unterschrift: &\\
\end{tabular}

\BLOCK{else}

die Vorlesungsumfrage ist nun ausgewertet. Wir bitten Sie, die Sie betreffenden
Stellen zu prüfen und uns die Genehmigung zur Veröffentlichung in der
Renthofpostille zu erteilen.

Sollten Sie einzelne Kommentare als unangebracht, beleidigend oder dem Zweck
der Vorlesungsumfrage nicht dienlich erachten, markieren Sie diese bitte. Wir
werden dann prüfen, ob die Kommentare gegebenenfalls gestrichen werden.

Wir bitten Sie, den unterschriebenen Zettel möglichst bald in den
\textbf{Fachschaftsbriefkasten} im RH5 zu werfen.

\textbf{Bitte nehmen Sie sich die Zeit, die Ergebnisse genau durchzulesen und
  mit den Studierenden zu besprechen. Nur so kann die Lehre an unserem
  Fachbereich stetig verbessert werden.}

Wenn Sie eine dauerhafte Einverständniserklärung abgeben möchten, können Sie
den dafür vorgesehenen Abschnitt ausfüllen und der Fachschaft zukommen
lassen. Das erleichtert uns und Ihnen die Arbeit in späteren
Vorlesungsumfragen. Es wird anschließend nach wie vor jeder Lehrende die ihn
betreffenden Ergebnisse erhalten und hat die Möglichkeit, binnen einer Frist
von \textbf{einer Woche} Einspruch gegen deren Veröffentlichung
einzulegen. Andernfalls wird von einem Einverständnis zur Veröffentlichung ausgegangen.

\vfill

\dingline{34}

Hiermit genehmige ich den Druck der mich betreffenden Ergebnisse der
Vorlesungsumfrage {\bf \VAR{vlu.name}} in der Renthofpostille.

\begin{tabular}{p{3cm}p{8cm}}
\vspace{0.5cm}   Datum:        &\\
\vspace{0.1cm} Name:         &\vspace{0.1cm}{\bf \VAR{dozent[1].name}}\\
\vspace{0.1cm} Unterschrift: &\\
\end{tabular}

\vspace{1cm}

\dingline{34}

Hiermit erkläre ich mich dauerhaft mit der Veröffentlichung der mich
betreffenden Ergebnisse der Vorlesungsumfrage einverstanden. Ich habe
verstanden, dass ich die Ergebnisse der Umfrage zwar erhalte, ihrer
Veröffentlichung im Falle eines Einspruches aber aktiv binnen einer Frist von
\textbf{einer Woche} nach Erhalt der Ergebnisse widersprechen muss. Diese
Einverständniserklärung ist jederzeit schriftlich widerrufbar.

\begin{tabular}{p{3cm}p{8cm}}
\vspace{0.5cm}   Datum:        &\\
\vspace{0.1cm} Name:         &\vspace{0.1cm}{\bf \VAR{dozent[1].name}}\\
\vspace{0.1cm} Unterschrift: &\\
\end{tabular}

\BLOCK{endif}
\newpage

\centerline{\bf Abgegebene Fragebögen: \VAR{vl.antwortboegen.all()|count}}

\begin{center}
  \begin{tabular}{p{3cm}p{3cm}p{5cm}l}
    {\bf Semesterverteilung:}&&{\bf Studiengänge:}& \\
    \BLOCK{for index in range(vl.studiengang_dist()|max(vl.semester_dist()))}
    \BLOCK{if vl.semester_dist()|count > index -}
      Semester \VAR{vl.semester_dist()[index]['key']}: & \VAR{vl.semester_dist()[index]['val']} 
    \BLOCK{- else} & \BLOCK{endif -}
    &
    \BLOCK{- if vl.studiengang_dist()|count > index -}
      \VAR{vl.studiengang_dist()[index]['key']}: & \VAR{vl.studiengang_dist()[index]['val']} 
    \BLOCK{- else} & \BLOCK{endif} \\
    \BLOCK{endfor}
  \end{tabular}
\end{center}
\Strich

% auswertung
\BLOCK{for fragenset in vl.fragebogen.fragensets.all()}
  \BLOCK{for frage in fragenset.fragenn(fragen)} 
    \BLOCK{if not frage.fragentyp.texttype and frage.total(vl) > 0}
      \Frage{\VAR{frage.text}}{\VAR{frage.total(vl)}}
      \BLOCK{- for option in frage.fragentyp.fast_optionen(optionen) -}
        \BLOCK{- if loop.first -}
          {\VAR{option.text|latexify}}{\Stats 
        \BLOCK{- endif -}
        {\VAR{(option.value(vl, frage) * 100)|int}}
        \BLOCK{- if loop.last -}
          {\VAR{((frage.mean(vlu)-1) * 100)|int}}
          {\VAR{((frage.mean(vl)-1) * 100)|int}}}
          {\VAR{option.text|latexify}}
        \BLOCK{- endif -}
      \BLOCK{- endfor} \\
    \BLOCK{- endif}
  \BLOCK{endfor}
\BLOCK{endfor}

\Strich
\centerline{\large Liste aller Kommentare:}

\BLOCK{for fragenset in vl.fragebogen.fragensets.all() -}
  \BLOCK{- for frage in fragenset.fragenn(fragen) -}
    \BLOCK{- if frage.fragentyp.texttype and frage.id != 34}
      {\bf \VAR{frage.text}}
      \BLOCK{if frage.antworten(vl)|count > 0 -}
        \begin{itemize}
          \setlength{\itemsep}{0cm} \setlength{\parsep}{0cm}
        \BLOCK{for k in frage.antworten(vl)}
          \item \VAR{k.text|latexify}
        \BLOCK{endfor}
        \end{itemize}
      \BLOCK{else}
        \begin{itemize}\item Keine Kommentare\end{itemize}
      \BLOCK{endif -}
    \BLOCK{- endif -}

    \BLOCK{- if frage.fragentyp.texttype and frage.id == 34}
      {\bf \VAR{frage.text}}
      \BLOCK{if vl.tutoren.all()|count > 0}
        \begin{itemize}
        \BLOCK{for tutor in vl.tutoren.all()}
          \item Gruppe von \VAR{tutor.name}
          \BLOCK{if frage.antworten(vl, tutor)|count > 0 -}
            \begin{itemize}
              \setlength{\itemsep}{0cm} \setlength{\parsep}{0cm}
            \BLOCK{for k in frage.antworten(vl, tutor)}
              \item \VAR{k.text|latexify}
            \BLOCK{endfor}
            \end{itemize}
          \BLOCK{- else -}
            \begin{itemize}\item Keine Kommentare\end{itemize}
          \BLOCK{endif -}
        \BLOCK{- endfor -}
        \end{itemize}
      \BLOCK{else}
        \begin{itemize}\item Keine Kommentare\end{itemize}
      \BLOCK{- endif}
    \BLOCK{endif}
  \BLOCK{- endfor -}
\BLOCK{- endfor}

\BLOCK{for fragenset in vl.fragebogen.fragensets.all() -}
  \BLOCK{- for frage in fragenset.fragenn(fragen) -}
    \BLOCK{- if frage.fragentyp.texttype and frage.id == 34}
      \BLOCK{if vl.tutoren.all()|count > 0}
        \BLOCK{for tutor in vl.tutoren.all()}
          \BLOCK{if frage.antworten(vl, tutor)|count > 0 -}
            \newpage
            \genehm{\VAR{tutor.name}}
            \newpage
            
            \centerline{\bf Abgegebene Fragebögen: \VAR{vl.antwortboegen.all()|count}}
            
            \begin{center}
              \begin{tabular}{p{3cm}p{3cm}p{5cm}l}
                {\bf Semesterverteilung:}&&{\bf Studiengänge:}& \\
                \BLOCK{for index in range(vl.studiengang_dist()|max(vl.semester_dist()))}
                \BLOCK{if vl.semester_dist()|count > index -}
                Semester \VAR{vl.semester_dist()[index]['key']}: & \VAR{vl.semester_dist()[index]['val']} 
                \BLOCK{- else} & \BLOCK{endif -}
                &
                \BLOCK{- if vl.studiengang_dist()|count > index -}
                \VAR{vl.studiengang_dist()[index]['key']}: & \VAR{vl.studiengang_dist()[index]['val']} 
                \BLOCK{- else} & \BLOCK{endif} \\
                \BLOCK{endfor}
              \end{tabular}
            \end{center}
            \Strich

            {\bf \VAR{frage.text}}\\
            Tutor: \VAR{tutor.name}
      
            \begin{itemize}
            \BLOCK{for k in frage.antworten(vl, tutor)}
              \item \VAR{k.text|latexify}
            \BLOCK{endfor}
            \end{itemize}
          \BLOCK{endif}
        \BLOCK{- endfor -}
      \BLOCK{endif}
    \BLOCK{endif}
  \BLOCK{- endfor -}
\BLOCK{- endfor}


\BLOCK{endfor}
\BLOCK{endif} % anzahl vorlesungen
\newpage
\BLOCK{endfor}

\end{document}

